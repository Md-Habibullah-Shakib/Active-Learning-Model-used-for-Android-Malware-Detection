import __init__
import keras
# Using Skicit-learn to split data into training and testing sets
from sklearn.model_selection import train_test_split
# Split the data into training and testing sets
train_ds, test_ds, train_L, test_L = train_test_split(ds, L, test_size = 0.20, random_state = 42)
print('Training dataset Shape:', train_ds.shape)
print('Training Labels Shape:', train_L.shape)
print('Testing dataset Shape:', test_ds.shape)
print('Testing Labels Shape:', test_L.shape)


# read training data
X_train = train_ds.reshape(80000, 134).astype('float32') / 255
X_test = test_ds.reshape(20000, 134).astype('float32') / 255
y_train = keras.utils.to_categorical(train_L, 80000)
y_test = keras.utils.to_categorical(test_L, 20000)

# assemble initial data
n_initial = 1000
initial_idx = np.random.choice(range(len(train_ds)), size=n_initial, replace=False)
X_initial = train_ds[initial_idx]
y_initial = train_L[initial_idx]

# generate the pool
# remove the initial data from the training dataset
X_pool = np.delete(train_ds, initial_idx, axis=0)[:5000]
y_pool = np.delete(train_L, initial_idx, axis=0)[:5000]