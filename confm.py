import __init__
import test_train
import alrf
from sklearn.metrics import classification_report, confusion_matrix
import seaborn as sns
import matplotlib.pyplot as plt
import numpy as np
matrix = confusion_matrix(train_labels, y_pred)
# Get and reshape confusion matrix data
matrix = matrix.astype('float') / matrix.sum(axis=1)[:, np.newaxis]

# Build the plot
plt.figure(figsize=(16,7))
sns.set(font_scale=1.4)
sns.heatmap(matrix, annot=True, annot_kws={'size':10},
            cmap=plt.cm.Blacks, linewidths=0.2)

# Add labels to the plot
class_namesx = ['benign', 'malware']
class_namesy = ['benign', 'malware']
tick_marks = np.arange(len(class_namesx))
tick_marks2 = tick_marks + 0.5
plt.xticks(tick_marks, class_namesx, rotation=25)
plt.yticks(tick_marks2, class_namesy, rotation=0)
plt.xlabel('Predicted label')
plt.ylabel('True label')
plt.title('Confusion Matrix for ALRandomForest Classifier')
plt.show()